<!-- navbar.ejs -->
<%
const menuItems = [
  {
    id: 'best',
    title: 'ì¸ê¸° ë„ì„œ',
    items: [
      {
        title: 'ì›”ê°„ ì¸ê¸°ë„ì„œ',
        description: 'ì´ë²ˆ ë‹¬ ê°€ì¥ ì¸ê¸°ìˆëŠ” ë„ì„œ!',
        icon: 'â­',
        path: '/monthlybestbook'
      },
      {
        title: 'ì£¼ê°„ ì¸ê¸°ë„ì„œ',
        description: 'ì´ë²ˆ ì£¼ ê°€ì¥ ì¸ê¸°ìˆëŠ” ë„ì„œ!',
        icon: 'ğŸ”¥',
        path: '/weeklybestbook'
      },
    ]
  },
  {
    id: 'community',
    title: 'ì—´ë¦°ë§ˆë‹¹',
    items: [
      {
        title: 'ê³µì§€ì‚¬í•­',
        description: 'ë„ì„œê´€ ê³µì§€ ì•ˆë‚´',
        icon: 'ğŸ“¢',
        path: '/noticeboard'
      },
      {
        title: 'ììœ  ê²Œì‹œíŒ',
        description: 'ììœ ë¡­ê²Œ ì‘ì„±í•˜ëŠ” ê²Œì‹œíŒ',
        icon: 'ğŸŒ',
        path: '/freeboard'
      },
    ]
  },
  {
    id: 'info',
    title: 'ë„ì„œê´€ ì•ˆë‚´',
    items: [
      {
        title: 'ì´ìš© ì•ˆë‚´',
        description: 'ë„ì„œê´€ ì´ìš© ì•ˆë‚´ì™€ ì œì œ ê·œì¹™',
        icon: 'â—',
        path: '/libraryinfo'
      },
    ]
  },
  {
    id: 'suggestion',
    title: 'ê±´ì˜ì‚¬í•­',
    items: [
      {
        title: 'ê±´ì˜ì‚¬í•­ ê²Œì‹œíŒ',
        description: 'ê±´ì˜ì‚¬í•­ ì‘ì„± ë° í™•ì¸',
        icon: 'ğŸ™‹',
        path: '/suggestionboard'
      },
      {
        title: 'í¬ë§ë„ì„œ ê²Œì‹œíŒ',
        description: 'ì‹ ì²­í•œ í¬ë§ë„ì„œì™€ í˜„í™©ì„ í™•ì¸',
        icon: 'ğŸ“˜',
        path: '/hopeboard'
      },
    ]
  },
  {
    id: 'mypage',
    title: 'ë§ˆì´í˜ì´ì§€',
    items: [
      {
        title: 'ë‚´ ì„œì¬',
        description: 'ëŒ€ì¶œ í˜„í™©ê³¼ ëŒ€ì¶œ ì´ë ¥ì„ í™•ì¸',
        icon: 'ğŸ“š',
        path: '/mylibrary'
      },
      {
        title: 'ê´€ì‹¬ ë„ì„œ',
        description: 'ê´€ì‹¬ë„ì„œë¡œ ì¶”ê°€í•œ ë„ì„œ ëª©ë¡ì„ í™•ì¸',
        icon: 'ğŸ”–',
        path: '/mybookmark'
      },
    ]
  }
];

const profileMenu = [
  { title: 'í”„ë¡œí•„ ì„¤ì •', path: '/profile/settings' },
  { title: 'ì•Œë¦¼', path: '/profile/notifications' },
];
%>

<nav class="navbar">
  <a href="/" class="navbar-brand">
    <img src="/images/libralink_logo_192.png" alt="LibraLink Logo" class="brand-logo">
    <span class="brand-text">LibraLink</span>
  </a>

  <div class="navbar-menu">
    <% menuItems.forEach(menu => { %>
      <div class="menu-item" data-menu-id="<%= menu.id %>">
        <button class="menu-button">
          <%= menu.title %>
          <svg class="menu-arrow" viewBox="0 0 24 24">
            <path d="M7 10l5 5 5-5" />
          </svg>
        </button>

        <div class="dropdown-menu">
          <div class="dropdown-header">
            <h3><%= menu.title %></h3>
            <p>ì›í•˜ì‹œëŠ” ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>
          </div>
          <div class="dropdown-content">
            <% menu.items.forEach(item => { %>
              <a href="<%= item.path %>" class="dropdown-item">
                <span class="item-icon"><%= item.icon %></span>
                <div class="item-info">
                  <h4><%= item.title %></h4>
                  <p><%= item.description %></p>
                </div>
                <svg class="item-arrow" viewBox="0 0 24 24">
                  <path d="M9 18l6-6-6-6" />
                </svg>
              </a>
            <% }); %>
          </div>
        </div>
      </div>
    <% }); %>
  </div>

  <div class="navbar-auth">
    <% if (!locals.isLoggedIn) { %>
      <button class="login-btn" onclick="window.location.href='/login'">
        <svg class="login-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
          <polyline points="10 17 15 12 10 7" />
          <line x1="15" y1="12" x2="3" y2="12" />
        </svg>
        ë¡œê·¸ì¸
      </button>
      <a href="/signup" class="signup-btn">íšŒì›ê°€ì…</a>
    <% } else { %>
      <div class="profile-menu-container">
        <div class="profile-button">
          <span class="user-name"><%= locals.userName %></span>
          <span class="profile-name">ë‹˜</span>
          <div class="profile-dropdown">
            <% profileMenu.forEach(item => { %>
              <a href="<%= item.path %>" class="profile-dropdown-item">
                <%= item.title %>
              </a>
            <% }); %>
            <div class="profile-dropdown-divider"></div>
            <form action="/logout" method="POST">
              <button type="submit" class="profile-dropdown-item">ë¡œê·¸ì•„ì›ƒ</button>
            </form>
          </div>
        </div>
      </div>
    <% } %>
  </div>
</nav>

<script>
// ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ë™ì‘ì„ ìœ„í•œ JavaScript
document.querySelectorAll('.menu-item').forEach(item => {
  item.addEventListener('mouseenter', () => {
    item.querySelector('.dropdown-menu').classList.add('active');
  });
  
  item.addEventListener('mouseleave', () => {
    item.querySelector('.dropdown-menu').classList.remove('active');
  });
});
</script>