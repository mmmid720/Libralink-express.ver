<!DOCTYPE html>
<html>
<head>
    <link rel="icon" href="/images/libralink_logo_192.png" />
    <title>LibraLink - 회원가입</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/signup.css">
    <% 
    // 데이터 선언
    let showTerms = false;
    let showPrivacy = false;
    %>
</head>
<body>
    <div class="signup-container">
        <div class="signup-box">
            <div class="logo-container">
                <a href="/" class="logo">LibraLink</a>
            </div>
            <form action="/signup" method="POST">
                <div class="form-group">
                    <label>아이디</label>
                    <div class="input-with-button">
                        <input type="text" name="username" placeholder="아이디를 입력해주세요." />
                        <button type="button" class="check-button" onclick="checkDuplicate()">중복확인</button>
                    </div>
                    <span id="idCheckResult"></span>
                </div>

                <div class="form-group">
                    <label>비밀번호</label>
                    <input 
                        type="password" 
                        name="password"
                        placeholder="비밀번호를 입력해주세요."
                    />
                </div>

                <div class="form-group">
                    <label>이름</label>
                    <input type="text" name="name" placeholder="홍길동" />
                </div>

                <div class="form-group">
                    <label>이메일</label>
                    <div class="input-with-button">
                        <input type="email" name="useremail" placeholder="email1234@gmail.com" />
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="terms" name="terms" />
                    <label for="terms">개인정보처리방침</label>
                    <button 
                        type="button" 
                        class="toggle-button" 
                        onclick="toggleTerms()"
                    >
                        펼치기 >>
                    </button>
                </div>

                <div id="termsModal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <h2>개인정보처리방침</h2>

                        <div class="section-title">제1조(회원 가입을 위한 정보)</div>
                        <div class="section-content">
                            회사는 이용자의 회사 서비스에 대한 회원가입을 위하여 다음과 같은 정보를 수집합니다.
                            <p>1. 필수 수집 정보: 이메일 주소, 비밀번호, 이름 및 닉네임</p>
                        </div>

                        <div class="section-title">제2조(본인 인증을 위한 정보)</div>
                        <div class="section-content">
                            회사는 이용자의 본인인증을 위하여 다음과 같은 정보를 수집합니다.
                            <p>1. 필수 수집 정보: 이메일 및 이름</p>
                        </div>

                        <div class="section-title">제3조(서비스 이용 및 부정 이용 확인을 위한 정보)</div>
                        <div class="section-content">
                            회사는 이용자의 서비스 이용에 따른 통계, 분석 및 부정이용의 확인, 분석을 위하여 다음과 같은 정보를 수집합니다.
                            <p>1. 필수 수집 정보: 서비스 이용기록</p>
                        </div>

                        <button type="button" onclick="closeTerms()">닫기</button>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="privacy" name="privacy" />
                    <label for="privacy">이용약관</label>
                    <button 
                        type="button" 
                        class="toggle-button" 
                        onclick="togglePrivacy()"
                    >
                        펼치기 >>
                    </button>
                </div>

                <div id="privacyModal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <h2>이용약관</h2>

                        <div class="section-title">제1조(목적)</div>
                        <div class="section-content">
                            이 약관은 LibraLink 도서관 홈페이지가 제공하는 서비스(이하 "서비스")의 이용 조건, 절차 및 기타 제반 사항을 규정하는 것을 목적으로 합니다.
                        </div>

                        <div class="section-title">제2조(목적)</div>
                        <div class="section-content">
                            ①이 약관에서 사용하는 용어의 정의는 다음 각 호와 같습니다.
                            <p>1. 이용자 : 본 약관에 따라 도서관 홈페이지가 제공하는 서비스를 받는 준회원 및 정회원</p>
                            <p>2. 가입 : 도서관이 제공하는 양식에 해당 정보를 기입하고, 본 약관에 동의하여 서비스 이용신청을 완료시키는 행위</p>
                            <p>3. 회원 : 도서관에 회원가입에 필요한 개인정보(실명확인)를 제공하여 회원 등록을 한 자</p>
                            <p>4. 준회원 : 홈페이지에서 실명인증을 거쳐 가입한 홈페이지 회원으로 각종 게시판 글쓰기 및 독서문화프로그램 신청, 디지털자료실 서비스 이용이 가능한 회원</p>
                            <p>5. 정회원 : 홈페이지 회원가입 후 도서관에 직접 방문하여 본인확인절차(신분증 제시)를 통해 회원카드가 발급된 회원으로 도서대출 및 도서관 홈페이지의 모든 서비스 이용이 가능한 회원</p>
                            <p>6. 서비스 : 도서관이 이용자에게 온/오프라인으로 제공하는 도서관 이용편의 및 정보</p>
                            <p>7. 이용자번호(ID) : 회원 식별과 회원의 서비스 이용을 위하여 이용자가 선택하고 도서관이 확인하는 영문자와 숫자의 조합(1인 1개의 ID만 발급 가능)</p>
                            <p>8. 비밀번호(PASSWORD) : 회원의 정보보호를 위해 이용자가 설정한 문자와 숫자, 특수문자 등으로 조합된 부호</p>
                            <p>9. 이용해지(탈퇴) : 도서관 및 도서관 이용 회원이 도서관 서비스 이용을 종료시키는 의사표시</p>
                        </div> 
                        
                        <div class="section-title">제3조(약관의 효력과 변경)</div>
                        <div class="section-content">
                            <p>① 이 약관은 서비스 화면에 게시 또는 기타의 방법으로 공지함으로써 이용자에게 공시되고, 이에 동의한 이용자가 서비스에 가입함으로써 효력이 발생하며, 도서관은 필요하다고 인정되는 경우 관련 법령에 위배되지 않는 범위 내에서 이 약관의 내용을 개정할 수 있고, 개정된 약관은 정당한 절차에 따라 서비스 화면에 공지됩니다.</p>
                            <p>② 이용자가 변경된 약관에 동의하지 않는 경우 회원 가입을 거부할 수 있으며, 계속 사용하시는 경우에는 약관 변경에 동의한 것으로 간주하고, 변경된 약관은 전항과 같은 방법으로 효력이 발생합니다.</p>
                            <p>③ 회원은 정기적으로 사이트를 방문하여 약관 변경여부를 확인하여야 합니다. 변경된 약관에 대한 정보를 인지하지 못해 발생하는 회원의 피해는 도서관에서 책임지지 않습니다.</p>
                            <p>④ 도서관은 필요한 경우 개별 서비스에 대하여 약관 및 이용규정(이하 ‘서비스별 안내’)을 정할 수 있으며 본 약관과 서로 상충되는 경우에는 서비스별 안내의 내용이 우선 적용됩니다.</p>
                            <p>⑤ 이 약관에 명시되지 않은 사항에 대해서는 관계 법률 및 기타법령의 규정에 따릅니다.</p>
                        </div>

                        <div class="section-title">제4조(이용신청)</div>
                        <div class="section-content">
                            이용신청은 도서관홈페이지의 회원등록 화면에서 이용자가 도서관에서 요구하는 신청양식 작성과 이용약관 및 개인정보 제공에 대한 동의로 신청합니다.
                        </div>

                        <button type="button" onclick="closePrivacy()">닫기</button>
                    </div>
                </div>

                <button type="submit" class="submit-button">가입하기</button>
            </form>
        </div>
    </div>

    <script>
        function toggleTerms() {
            document.getElementById('termsModal').style.display = 'block';
        }

        function closeTerms() {
            document.getElementById('termsModal').style.display = 'none';
        }

        function togglePrivacy() {
            document.getElementById('privacyModal').style.display = 'block';
        }

        function closePrivacy() {
            document.getElementById('privacyModal').style.display = 'none';
        }

        function checkDuplicate() {
            // 아이디 중복확인 로직
        }
        // 서버로 중복 확인 요청
        fetch('/api/check-duplicate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ userId: userId })
            })
            .then(response => response.json())
            .then(data => {
                if (data.isDuplicate) {
                    resultSpan.className = 'error-message';
                    resultSpan.textContent = '이미 가입된 아이디입니다.';
                } else {
                    resultSpan.className = 'success-message';
                    resultSpan.textContent = '사용 가능한 아이디입니다!';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                resultSpan.className = 'error-message';
                resultSpan.textContent = '중복 확인 중 오류가 발생했습니다.';
            });
    </script>
</body>
</html>